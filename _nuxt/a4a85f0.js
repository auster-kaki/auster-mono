(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{551:function(e,t,n){var content=n(580);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(24).default)("69bc35f2",content,!0,{sourceMap:!1})},552:function(e,t,n){var content=n(582);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(24).default)("d84bc800",content,!0,{sourceMap:!1})},579:function(e,t,n){"use strict";n(551)},580:function(e,t,n){var r=n(23)((function(i){return i[1]}));r.push([e.i,"@keyframes bounce-1b02fd2e{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}.animate-bounce[data-v-1b02fd2e]{animation:bounce-1b02fd2e 2s infinite}",""]),r.locals={},e.exports=r},581:function(e,t,n){"use strict";n(552)},582:function(e,t,n){var r=n(23)((function(i){return i[1]}));r.push([e.i,"[data-v-c2c55b98] .v-carousel__controls__item.v-btn{color:rgba(0,0,0,.54)}.card-actions[data-v-c2c55b98]{align-items:center;display:flex;justify-content:space-between}.custom-button[data-v-c2c55b98]{background-color:#4e97e0;border-radius:2px;color:#fff;display:inline-block;font-size:16px;font-weight:700;padding:4px 8px;text-align:center}@keyframes bounce-c2c55b98{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}.animate-bounce[data-v-c2c55b98]{animation:bounce-c2c55b98 2s infinite}",""]),r.locals={},e.exports=r},626:function(e,t,n){"use strict";n.r(t);var r=n(522),o=n(521),c=n(545),l=n(228),f=n(185),d=n(0),v=Object(d.defineComponent)({__name:"DiaryCard",props:{value:null},emits:["click"],setup:function(e,t){var n=t.emit,r=e;return{__sfc:!0,props:r,emit:n,openDiaryModal:function(){n("click",r.value)}}}}),_=(n(579),n(60)),component=Object(_.a)(v,(function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t(r.a,{on:{click:n.openDiaryModal}},[t(f.a,{staticStyle:{position:"relative","object-fit":"cover","object-position":"center top"},attrs:{src:e.value.image,height:"300"}},[e.value.isOffer?t(c.a,{staticClass:"elevation-4",class:["animate-bounce"],staticStyle:{position:"absolute",bottom:"15px",right:"10px"},attrs:{color:"accent"}},[t(l.a,{attrs:{size:"24"}},[e._v("mdi-email")]),e._v(" "),t("strong",[e._v("スペシャルオファー！")])],1):e._e()],1),e._v(" "),t(o.d,[e._v(e._s(e.value.title))]),e._v(" "),t(o.b,[e._v(e._s(e.value.date)+" - "+e._s(e.value.location))]),e._v(" "),t(o.c,[e._v(e._s(e.value.content?e.value.content.substring(0,100)+"...":""))])],1)}),[],!1,null,"1b02fd2e",null);t.default=component.exports},627:function(e,t,n){"use strict";n.r(t);var r=n(251),o=n(522),c=n(521),l=n(545),f=n(519),d=n(228),v=n(185),_=n(544),m=n(537),h=n(516),y=(n(46),n(31),n(65),n(0)),k={props:{diary:{type:[Object],required:!0},isOffer:{type:[Boolean],default:!1}},setup:function(e,t){var n=t.emit,r=Object(y.ref)(!1),o=Object(y.ref)(""),c=Object(y.ref)(e.diary.content);Object(y.watch)((function(){return e.diary.content}),(function(e){c.value=e}));var l=function(e){o.value=e,r.value=!0};return{snackbar:r,snackbarMessage:o,localContent:c,updateContent:function(e){n("update:content",e)},showDownloadMessage:function(){l("日記がダウンロードできる予定です")},showBookmarkMessage:function(){l("ブックマークして後から見返せるようになる予定です")},showShareMessage:function(){l("SNSでシェアできるようになる予定です")},acceptTheOffer:function(){l("オファーを受けて、旅程が組まれる予定です")},handleSelect:function(){n("select",e.diary.id)},updateDiary:function(){l("日記が更新されました")}}}},x=(n(581),n(60)),component=Object(x.a)(k,(function(){var e=this,t=e._self._c;return t("div",[t(o.a,{staticStyle:{position:"relative"},attrs:{flat:""}},[t(f.a,[t(_.a,{staticClass:"pa-2 align-center"},[t("div",{staticClass:"custom-button mr-2"},[e._v("\n          "+e._s(e.diary.date.slice(0,4))),t("br"),e._v("\n          "+e._s(e.diary.date.slice(5).replace("/",""))+"\n        ")]),e._v(" "),t("h3",{staticClass:"text-center font-weight-bold"},[e._v(e._s(e.diary.title))]),e._v(" "),t(h.a),e._v(" "),t(d.a,{attrs:{size:"24"},on:{click:e.showBookmarkMessage}},[e._v("mdi-bookmark")])],1),e._v(" "),t(_.a,{staticClass:"px-2"},[t(v.a,{staticStyle:{"border-radius":"4px",position:"relative"},attrs:{src:e.diary.image,alt:e.diary.title,cover:"",height:"270",width:"100%"}},[e.isOffer?t(l.a,{staticClass:"elevation-4",class:["animate-bounce"],staticStyle:{position:"absolute",bottom:"15px",right:"10px"},attrs:{color:"accent"}},[t(d.a,{attrs:{size:"24"}},[e._v("mdi-email")]),e._v(" "),t("strong",[e._v("スペシャルオファー！")])],1):e._e()],1)],1)],1),e._v(" "),t(c.c,{staticClass:"text-body-1",staticStyle:{"overflow-y":"auto"}},[t("div",[e._v(e._s(e.diary.content))])]),e._v(" "),t(c.a,[e.isOffer?t(r.a,{staticClass:"px-4 py-2 mb-2",attrs:{color:"primary"},on:{click:e.acceptTheOffer}},[t("span",{staticClass:"text-white font-weight-bold"},[e._v("オファーを受ける")])]):e._e(),e._v(" "),t(h.a),e._v(" "),t(r.a,{attrs:{icon:""},on:{click:e.showShareMessage}},[t(d.a,{attrs:{size:"x-large"}},[e._v("mdi-share-variant")])],1),e._v(" "),t(r.a,{staticClass:"mr-4",attrs:{icon:""},on:{click:e.showDownloadMessage}},[t(d.a,{attrs:{size:"x-large"}},[e._v("mdi-download")])],1)],1)],1),e._v(" "),t(m.a,{staticClass:"text-center",attrs:{timeout:2e3,color:"accent"},model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v("\n    "+e._s(e.snackbarMessage)+"\n  ")])],1)}),[],!1,null,"c2c55b98",null);t.default=component.exports},725:function(e,t,n){"use strict";n.r(t);var r=n(251),o=n(522),c=n(521),l=n(541),f=n(519),d=n(714),v=n(185),_=n(226),m=n(151),h=n(230),y=n(87),k=n(544),x=n(537),O=n(516),w=n(713),M=n(736),D=n(735),j=n(707),C=(n(9),n(66),n(40),n(29)),S=(n(35),n(67),n(344),n(6),n(189),n(43),n(54),n(55),n(243),n(112),n(626)),T=n(241),E={components:{HistoryDiary:n(627).default,DiaryCard:S.default},layout:"mobile",data:function(){return{userInfo:{},activeTab:null,diaries:[],encounters:[],diaryModalOpen:!1,encounterModalOpen:!1,snackbar:!1,selectedDiary:null,selectedEncounter:null,diaryDetail:{id:"",date:"",image:"",title:"",content:"",isOffer:!1}}},mounted:function(){var e=this;return Object(C.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=Object(T.a)()).initializeUser(),e.userInfo=n.userInfo,t.next=5,e.fetchHistories();case 5:case"end":return t.stop()}}),t)})))()},methods:{fetchHistories:function(){var e=this;return Object(C.a)(regeneratorRuntime.mark((function t(){var n,r,o,c,l,data,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=new URLSearchParams({user_id:e.userInfo.id,filter:"done"}),t.next=4,fetch("".concat("https://5a05-2400-2410-ab62-9000-e81c-85fe-1280-19f.ngrok-free.app","/reservations?").concat(n.toString()),{method:"GET",headers:{"Content-Type":"application/json"}});case 4:return r=t.sent,t.next=7,r.json();case 7:o=t.sent,e.diaries=o.reservations.map((function(e){return{image:"".concat("https://5a05-2400-2410-ab62-9000-e81c-85fe-1280-19f.ngrok-free.app","/images").concat(e.diary_photo_path),id:e.id,title:e.travel_spot_title,date:e.from_date.split("T")[0],location:"銚子",content:e.travel_spot_description,isOffer:e.is_offer}})).sort((function(a,b){return b.isOffer!==a.isOffer?b.isOffer-a.isOffer:new Date(b.date)-new Date(a.date)})),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error("履歴の取得に失敗しました",t.t0);case 14:return t.prev=14,c=new URLSearchParams({user_id:e.userInfo.id}),t.next=18,fetch("".concat("https://5a05-2400-2410-ab62-9000-e81c-85fe-1280-19f.ngrok-free.app","/encounters?").concat(c.toString()),{method:"GET",headers:{"Content-Type":"application/json"}});case 18:return l=t.sent,t.next=21,l.json();case 21:data=t.sent,f=data.reduce((function(t,n){return t[n.Name]||(t[n.Name]={name:n.Name,place:n.Place,details:[]}),t[n.Name].details.push({date:e.formatDate(n.Date),description:n.Description}),t}),{}),e.encounters=Object.values(f),t.next=29;break;case 26:t.prev=26,t.t1=t.catch(14),console.error("関係事業者の取得に失敗しました",t.t1);case 29:case"end":return t.stop()}}),t,null,[[0,11],[14,26]])})))()},fetchHistoryDetail:function(e){var t=this;return Object(C.a)(regeneratorRuntime.mark((function n(){var r,data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch("".concat("https://5a05-2400-2410-ab62-9000-e81c-85fe-1280-19f.ngrok-free.app","/reservations/").concat(e));case 3:return r=n.sent,n.next=6,r.json();case 6:data=n.sent,t.diaryDetail={id:data.id,date:data.from_date.split("T")[0],image:"".concat("https://5a05-2400-2410-ab62-9000-e81c-85fe-1280-19f.ngrok-free.app","/images").concat(data.diary_photo_path),title:data.diary_title,content:data.diary_description,isOffer:data.is_offer},n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),console.error("Failed to fetch itinerary:",n.t0);case 13:case"end":return n.stop()}}),n,null,[[0,10]])})))()},openDiaryModal:function(e){var t=this;return Object(C.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.fetchHistoryDetail(e.id);case 2:console.log(e,t.diaries),t.selectedDiary=t.diaryDetail,t.diaryModalOpen=!0;case 5:case"end":return n.stop()}}),n)})))()},openEncounterModal:function(e){this.selectedEncounter=e,this.encounterModalOpen=!0},openChat:function(){this.snackbar=!0},formatDate:function(e){return e?e.split("T")[0]:(console.log("formatDate target not found",e),e)}}},R=n(60),component=Object(R.a)(E,(function(){var e,t=this,n=t._self._c;return n(f.a,{staticClass:"mb-16"},[n(D.a,{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[n(w.a,[t._v("日記")]),t._v(" "),n(w.a,[t._v("出会った人々")])],1),t._v(" "),n(j.a,{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[n(M.a,[n(f.a,[n(k.a,t._l(t.diaries,(function(e,r){return n(l.a,{key:r,attrs:{cols:"12",sm:"6",md:"4"}},[n("diary-card",{attrs:{value:e},on:{click:function(n){return t.openDiaryModal(e)}}})],1)})),1)],1)],1),t._v(" "),n(M.a,[n(_.a,t._l(t.encounters,(function(e,r){return n(m.a,{key:r,on:{click:function(n){return t.openEncounterModal(e)}}},[n(h.a,[n(v.a,{attrs:{src:e.avatar}})],1),t._v(" "),n(y.a,[n(y.c,[t._v(t._s(e.name))]),t._v(" "),n(y.b,[t._v(t._s(e.place))])],1)],1)})),1)],1)],1),t._v(" "),n(d.a,{model:{value:t.diaryModalOpen,callback:function(e){t.diaryModalOpen=e},expression:"diaryModalOpen"}},[n("history-diary",{attrs:{diary:t.selectedDiary,"is-offer":null===(e=t.selectedDiary)||void 0===e?void 0:e.isOffer}})],1),t._v(" "),n(d.a,{attrs:{"max-width":"600"},model:{value:t.encounterModalOpen,callback:function(e){t.encounterModalOpen=e},expression:"encounterModalOpen"}},[t.selectedEncounter?n(o.a,[n(c.d,[t._v(t._s(t.selectedEncounter.name))]),t._v(" "),n(c.b,[t._v(t._s(t.selectedEncounter.place))]),t._v(" "),n(c.c,[n(_.a,t._l(t.selectedEncounter.details,(function(e,r){return n(m.a,{key:r},[n(y.a,[n(y.b,{staticClass:"text-subtitle-2"},[t._v(t._s(e.date))]),t._v(" "),n(y.c,{staticClass:"text-h6"},[t._v(t._s(e.description))])],1)],1)})),1)],1),t._v(" "),n(c.a,[n(O.a),t._v(" "),n(r.a,{attrs:{color:"primary",outlined:""},on:{click:function(e){return t.openChat(t.selectedEncounter)}}},[t._v("チャットを開く")])],1)],1):t._e()],1),t._v(" "),n(x.a,{attrs:{color:"accent",timeout:3e3},scopedSlots:t._u([{key:"action",fn:function(e){var o=e.attrs;return[n(r.a,t._b({attrs:{text:""},on:{click:function(e){t.snackbar=!1}}},"v-btn",o,!1),[t._v("\n        閉じる\n      ")])]}}]),model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v("\n    チャットが開始できる想定です\n    ")])],1)}),[],!1,null,null,null);t.default=component.exports}}]);