(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{727:function(t,e,r){"use strict";r.r(e);var n=r(251),o=r(522),c=r(521),l=r(541),f=r(519),v=r(228),h=r(185),_=r(544),m=r(537),d=r(516),k=r(29),x=(r(35),r(67),r(6),r(43),r(54),r(55),r(243),r(112),r(241)),w={name:"IndexPage",layout:"mobile",data:function(){return{userInfo:{},reservations:[],snackbar:{show:!1,text:"",timeout:3e3,color:"success",closeText:"閉じる",closeIcon:"mdi-close"}}},mounted:function(){var t=this;return Object(k.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"success"===t.$route.query.reservation&&t.showSnackbar("予約が完了しました！"),(r=Object(x.a)()).initializeUser(),t.userInfo=r.userInfo,e.next=6,t.fetchReservations();case 6:case"end":return e.stop()}}),e)})))()},methods:{formatDate:function(t){return new Date(t).toLocaleDateString("ja-JP")},goToItinerary:function(t){this.$router.push("/c/reservations/".concat(t,"/itinerary"))},fetchReservations:function(){var t=this;return Object(k.a)(regeneratorRuntime.mark((function e(){var r,n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new URLSearchParams({user_id:t.userInfo.id,filter:"yet"}),e.prev=1,e.next=4,fetch("".concat("https://5a05-2400-2410-ab62-9000-e81c-85fe-1280-19f.ngrok-free.app","/reservations?").concat(r.toString()),{method:"GET",headers:{"Content-Type":"application/json"}});case 4:return n=e.sent,e.next=7,n.json();case 7:data=e.sent,t.reservations=data.reservations.map((function(t){return{id:t.id,title:t.travel_spot_title,fromDate:t.from_date.split("T")[0],toDate:t.to_date.split("T")[0],city:"銚子",image:"".concat("https://5a05-2400-2410-ab62-9000-e81c-85fe-1280-19f.ngrok-free.app","/images/").concat(t.diary_photo_path),isOffer:t.is_offer}})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error("予約の取得に失敗しました",e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})))()},showSnackbar:function(text){this.snackbar.text=text,this.snackbar.show=!0}}},y=r(60),component=Object(y.a)(w,(function(){var t=this,e=t._self._c;return e(f.a,[e(_.a,{attrs:{justify:"center",align:"center"}},[e(l.a,{attrs:{cols:"12"}},[e("h2",{staticClass:"text-center mb-4"},[t._v("予約確認")]),t._v(" "),0===t.reservations.length?e(o.a,{attrs:{flat:""}},[e(c.c,{staticClass:"text-center"},[t._v("予約がありません")])],1):t._l(t.reservations,(function(r){return e(o.a,{key:r.id,staticClass:"mb-4",attrs:{flat:""}},[e(_.a,{attrs:{"no-gutters":""}},[e(l.a,{attrs:{cols:"4"}},[e(h.a,{attrs:{src:r.image,"max-height":"128px","max-width":"158px",cover:""}})],1),t._v(" "),e(l.a,{staticClass:"px-2",attrs:{cols:"8"}},[e(f.a,[e(_.a,[e("strong",[t._v(t._s(r.title))])]),t._v(" "),e(_.a,[t._v("\n                "+t._s(t.formatDate(r.fromDate))+" - "+t._s(r.toDate)+"\n              ")]),t._v(" "),e(_.a,[e("div",[t._v(t._s(r.city))]),t._v(" "),e(d.a),t._v(" "),e(n.a,{staticClass:"mt-4",attrs:{color:"primary",outlined:""},on:{click:function(e){return t.goToItinerary(r.id)}}},[t._v("\n                  旅程確認・日記更新\n                ")])],1)],1)],1)],1)],1)}))],2)],1),t._v(" "),e(m.a,{attrs:{timeout:t.snackbar.timeout,color:t.snackbar.color,dense:"","close-text":t.snackbar.closeText,"close-icon":t.snackbar.closeIcon},scopedSlots:t._u([{key:"action",fn:function(r){var o=r.attrs;return[e(n.a,t._b({attrs:{text:""},on:{click:function(e){t.snackbar.show=!1}}},"v-btn",o,!1),[e(v.a,[t._v(t._s(t.snackbar.closeIcon))])],1)]}}]),model:{value:t.snackbar.show,callback:function(e){t.$set(t.snackbar,"show",e)},expression:"snackbar.show"}},[t._v("\n    "+t._s(t.snackbar.text)+"\n    ")])],1)}),[],!1,null,null,null);e.default=component.exports}}]);